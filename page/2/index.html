<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="IFchanged" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta property="og:type" content="website">
<meta property="og:title" content="IFchanged">
<meta property="og:url" content="http://ifchanged.io/page/2/index.html">
<meta property="og:site_name" content="IFchanged">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="IFchanged">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://ifchanged.io/page/2/"/>





  <title> IFchanged </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-99172222-1', 'auto');
  ga('send', 'pageview');
</script>











  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">IFchanged</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://ifchanged.io/2015/git-rebase实践/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zeroten">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IFchanged">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/git-rebase实践/" itemprop="url">
                  git rebase实践
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-10-28T19:54:15+08:00">
                2015-10-28
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/git-rebase实践/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2015/git-rebase实践/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="准备知识"><a href="#准备知识" class="headerlink" title="准备知识"></a>准备知识</h2><h3 id="分支"><a href="#分支" class="headerlink" title="分支"></a>分支</h3><p>同一个分支有三种表现形式</p>
<ol>
<li>远程分支</li>
<li>远程引用分支 origin/master</li>
<li>本地分支    master</li>
</ol>
<p>fetch会更新远程引用分支，本地分支merge远程引用分支之后才会更新本地分支。</p>
<h3 id="pull"><a href="#pull" class="headerlink" title="pull"></a>pull</h3><p>pull实际执行了<code>git fetch</code>和<code>git merge FETCH_HEAD</code>两条指令</p>
<h3 id="rebase的意义"><a href="#rebase的意义" class="headerlink" title="rebase的意义"></a>rebase的意义</h3><p>rebase的作用是重写提交记录。</p>
<ul>
<li><p>rebase优点：</p>
<ol>
<li>合并commit（与前分支rebase）</li>
<li>避免merge commit（与master rebase）</li>
<li>重写提交记录</li>
</ol>
</li>
<li><p>rebase缺点：</p>
</li>
</ul>
<ol>
<li>操作不慎会丢失commit</li>
<li>影响不到的冲突（由merge commit引起）</li>
</ol>
<p>在操作不熟练时，可以先备份分支<code>checkout -b bak_xxx</code>。</p>
<p>merge+revert的方式可以保证代码的安全性，但提交记录混乱。rebase+reset的方式能够保证提交记录的清晰。</p>
<h2 id="新建分支"><a href="#新建分支" class="headerlink" title="新建分支"></a>新建分支</h2><h3 id="创建新的分支"><a href="#创建新的分支" class="headerlink" title="创建新的分支"></a>创建新的分支</h3><p>开始需求时，需要建立一个新分支，并把它推送到远程仓库。新建分支的方法多种多样，唯一的原则是从master新建分支。</p>
<ol>
<li>更新master<ol>
<li><code>git checkout master</code></li>
<li><code>git pull</code></li>
</ol>
</li>
<li>从master创建feature分支：<br> <code>git checkout master -b test</code> 或 <code>git checkout origin/master -b</code></li>
<li>推送分支当远程<br>  <code>git push -u origin test:test</code> 本地分支名在前<br> -u是–set-upstream-to 的简写，设置追踪分支。</li>
</ol>
<h3 id="拉取分支"><a href="#拉取分支" class="headerlink" title="拉取分支"></a>拉取分支</h3><p>其他人在此分支协作时的获取。<br>    <code>git checkout --track origin/test</code></p>
<h2 id="更新分支"><a href="#更新分支" class="headerlink" title="更新分支"></a>更新分支</h2><h3 id="从master更新"><a href="#从master更新" class="headerlink" title="从master更新"></a>从master更新</h3><ol>
<li><strong>方案1</strong><ol>
<li><code>git checkout master</code></li>
<li><code>git pull</code></li>
<li><code>git checkout test</code></li>
<li><code>git rebase master</code></li>
</ol>
</li>
<li><strong>方案2（推荐）</strong><br> <code>git pull --rebase origin master</code><br> <strong>注意：</strong>此种方法不会更新本地master分支</li>
</ol>
<h3 id="从test更新"><a href="#从test更新" class="headerlink" title="从test更新"></a>从test更新</h3><p><code>git pull --rebase</code><br><strong>注意</strong>：需要先设置跟踪分支</p>
<h2 id="完成后合并到master"><a href="#完成后合并到master" class="headerlink" title="完成后合并到master"></a>完成后合并到master</h2><p>在test分支开发<strong>完成</strong>后，需要通过rebase合并commit，此时rebase的目标不再是分支，而是在test分支中的commit。</p>
<h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><ol>
<li>从master更新test分支，方法见上文</li>
<li>寻找rebase点，使用<code>git log</code>查看test分支中最后一个commit，如<br>66fc050b </li>
<li><code>rebase -i 66fc050b</code>开始rebase</li>
</ol>
<h3 id="交互式rebase"><a href="#交互式rebase" class="headerlink" title="交互式rebase"></a>交互式rebase</h3><p>在执行rebase -i命令会打开sublime编辑器<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">pick <span class="number">66</span>fc050 Test:git pull --rebase origin <span class="keyword">master</span></div><div class="line"><span class="title">pick</span> a8b6d2f <span class="number">2</span></div><div class="line">pick c2c1903 xsas</div><div class="line"></div><div class="line"><span class="comment"># Rebase 749e319..c2c1903 onto 749e319 (3 command(s))</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># Commands:</span></div><div class="line"><span class="comment"># p, pick = use commit</span></div><div class="line"><span class="comment"># r, reword = use commit, but edit the commit message</span></div><div class="line"><span class="comment"># e, edit = use commit, but stop for amending</span></div><div class="line"><span class="comment"># s, squash = use commit, but meld into previous commit</span></div><div class="line"><span class="comment"># f, fixup = like "squash", but discard this commit's log message</span></div><div class="line"><span class="comment"># x, exec = run command (the rest of the line) using shell</span></div><div class="line"><span class="comment"># d, drop = remove commit</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># These lines can be re-ordered; they are executed from top to bottom.</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># If you remove a line here THAT COMMIT WILL BE LOST.</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># However, if you remove everything, the rebase will be aborted.</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># Note that empty commits are commented out</span></div></pre></td></tr></table></figure></p>
<p>内容以<code>动作 commitID commit信息</code>的形式展现，66fc050、a8b6d2f、c2c1903就是三次提交，如果需要合并三次提交，修改成<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">pick <span class="number">66</span>fc050 Test:git pull --rebase origin <span class="keyword">master</span></div><div class="line"><span class="title">f</span> a8b6d2f <span class="number">2</span></div><div class="line">f c2c1903 xsas</div></pre></td></tr></table></figure></p>
<p>然后保存文件并退出sublime。</p>
<p>如果rebase过程中遇到冲突，解决完冲突后执行<code>git rebase --continue</code>，需要注意的是，即使强制关闭控制台，依然会处于rebase状态，需要执行<code>git rebase --abort</code>取消rebase，版本库会会滚刀rebase之前的状态。或者执行<code>git rebase --edit-todo</code>重新打开rebase文件。</p>
<p>如果产生冲突，rebase会逐个释放冲突，处理完冲突后，执行<code>git rebase --continue</code>继续。</p>
<h3 id="推送到远程仓库"><a href="#推送到远程仓库" class="headerlink" title="推送到远程仓库"></a>推送到远程仓库</h3><p>test分支经过rebase后，显然已经和远程分支冲突了，<br>需要强制提交:<br><code>git push -f</code><br>或者先删除远程分支:</p>
<ol>
<li><code>git push origin --delete test</code></li>
<li><code>git push origin test:test</code></li>
</ol>
<h3 id="管理员合并分支"><a href="#管理员合并分支" class="headerlink" title="管理员合并分支"></a>管理员合并分支</h3><p>最终由管理员把test分支合并到master，需要注意的是合并前需要把test分支从master分支rebase更新，避免merge commit。</p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="使用Sublime-Text作为外部文本编辑器"><a href="#使用Sublime-Text作为外部文本编辑器" class="headerlink" title="使用Sublime Text作为外部文本编辑器"></a>使用Sublime Text作为外部文本编辑器</h3><p>对git进行设置通常使用git config命令或者直接编辑.config文件</p>
<p><code>git config --global core.editor &quot;&#39;C:/Program Files/Sublime Text 2/sublime_text.exe&#39; -w&quot;</code><br>或<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[<span class="name">core</span>]</div><div class="line">	editor = <span class="symbol">'C:</span>\\Program Files\\Sublime Text <span class="number">2</span>\\sublime_text.exe' -w</div></pre></td></tr></table></figure></p>
<h3 id="rebase取代merge"><a href="#rebase取代merge" class="headerlink" title="rebase取代merge"></a>rebase取代merge</h3><p><code>git config --global branch.autosetuprebase always</code><br>或<br><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">[branch]</span></div><div class="line">	autosetuprebase = always</div></pre></td></tr></table></figure></p>
<h3 id="reset在合并提交中的应用"><a href="#reset在合并提交中的应用" class="headerlink" title="reset在合并提交中的应用"></a>reset在合并提交中的应用</h3><p><code>git reset commitId</code> commitId 的位置同rebase，reset会撤销提交，一切回滚到<code>git add</code>和<code>git commit</code>之前的状态，所以我们可以把所有修改一次commit，达到合并commit的作用。</p>
<p>需要注意的是，reset后，提交人信息和提交信息(commit msg)都会丢失。</p>
<h3 id="git-hooks-go"><a href="#git-hooks-go" class="headerlink" title="git_hooks_go"></a>git_hooks_go</h3><p>通过git hooks的方式为提交信息添加用户名、分支名等信息，方便rebase。<br>运行git_hooks_go目录下的install.py安装。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ol>
<li>从master创建分支</li>
<li>使用rebase更新</li>
<li>使用rebase -i 合并commit</li>
<li>管理员合并分支</li>
</ol>
<p>更新git：<br><a href="http://git-scm.com/download/" target="_blank" rel="external">http://git-scm.com/download/</a></p>
<p>git文档：</p>
<ol>
<li><a href="http://git-scm.com/book/zh/v2" target="_blank" rel="external">http://git-scm.com/book/zh/v2</a></li>
<li><a href="https://www.atlassian.com/git/tutorials/" target="_blank" rel="external">https://www.atlassian.com/git/tutorials/</a></li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://ifchanged.io/2015/使用页面可见性API-Visibility/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zeroten">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IFchanged">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/使用页面可见性API-Visibility/" itemprop="url">
                  使用页面可见性API Visibility
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-09-25T18:38:43+08:00">
                2015-09-25
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/使用页面可见性API-Visibility/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2015/使用页面可见性API-Visibility/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>可见性API的好处是判断当前页面是否可见，并基于此执行不同的操作，通常可以节省不少资源，比如轮询，比如视频播放。</p>
<p>可见性API包括两个属性<strong>document.hidden</strong>、<strong>document.visibilityState</strong>和一个事件<strong>visibilitychange</strong>。</p>
<h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><p>HTML5扩展了document的接口，增加了<code>hidden</code>和<code>visibilityState</code>两个属性，它们的含义也比较接近。</p>
<p><code>hidden</code>返回一个布尔值，表示页面是否完全不可见。<code>visibilityState</code>表示可见状态，返回一个字符串，可能的返回值是<code>visible</code>、<code>hidden</code>、<code>prerender</code>、<code>uploaded</code>，具体含义可以看MDN的介绍<a href="https://developer.mozilla.org/zh-CN/docs/Web/Guide/User_experience/Using_the_Page_Visibility_API" target="_blank" rel="external">使用页面可见性API</a></p>
<p><code>visibilitychange</code>事件当页面可见性改变的时候会触发。</p>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><p>结合两个属性和事件，可以很好的根据页面可见性进行一些操作，比如<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">document</span>.addEventListener(<span class="string">"visibilitychange"</span>, func, <span class="literal">false</span>);</div><div class="line"></div><div class="line"><span class="keyword">if</span>(<span class="built_in">document</span>.visibilityState == <span class="string">'visible'</span>)&#123;  </div><div class="line">    <span class="comment">//do sth.</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">document</span>.visibilityState == <span class="string">'hidden'</span>)&#123;</div><div class="line">    <span class="comment">//do sth.</span></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>参考文档：</p>
<ul>
<li><a href="http://www.w3.org/TR/page-visibility/" target="_blank" rel="external">http://www.w3.org/TR/page-visibility/</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/Events/visibilitychange" target="_blank" rel="external">https://developer.mozilla.org/en-US/docs/Web/Events/visibilitychange</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/Guide/User_experience/Using_the_Page_Visibility_API" target="_blank" rel="external">https://developer.mozilla.org/zh-CN/docs/Web/Guide/User_experience/Using_the_Page_Visibility_API</a></li>
<li><a href="http://blogs.msdn.com/b/ie/archive/2011/07/08/using-pc-hardware-more-efficiently-in-html5-new-web-performance-apis-part-2.aspx" target="_blank" rel="external">http://blogs.msdn.com/b/ie/archive/2011/07/08/using-pc-hardware-more-efficiently-in-html5-new-web-performance-apis-part-2.aspx</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://ifchanged.io/2015/MySQL时间精确度问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zeroten">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IFchanged">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/MySQL时间精确度问题/" itemprop="url">
                  MySQL时间精确度问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-09-20T00:17:59+08:00">
                2015-09-20
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/MySQL时间精确度问题/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2015/MySQL时间精确度问题/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="问题背景"><a href="#问题背景" class="headerlink" title="问题背景"></a>问题背景</h2><p>在项目最近的自动化测试中，会出现一个随机出现的报错，表现为根据生成时间排序的item有时候会和预期不符。经确认，该问题是由MySQL中默认情况下时间只存储到秒引起的，所以，在自动化测试服务器快速生成item时，可能出现先后创建的项目记录为同一个生成时间，在相关页面以生成时间排序时顺序可能和预期不符。</p>
<h2 id="问题探究"><a href="#问题探究" class="headerlink" title="问题探究"></a>问题探究</h2><p>在MySQL默认情况下， 时间只会精确到秒。在MySQL 5.6.4之前，时间只能精确保存到秒，在MySQL 5.6.4之后以分数秒（Fractional Seconds）的形式保存更精确的时间，格式形如’2010-12-10 14:12:09.019473’。</p>
<h3 id="fractional-seconds的使用"><a href="#fractional-seconds的使用" class="headerlink" title="fractional seconds的使用"></a>fractional seconds的使用</h3><p>截止到MySQL 5.7，时间的最大精确度是微妙（microsecond）。使用fractional seconds需要使用语法<code>type_name(fsp)</code>,type_name可为TIME, DATETIME, 和TIMESTAMP类型，fsp表示精度，取值范围是0-6，6时即表示微妙。例如<code>CREATE TABLE t1 (t TIME(3), dt DATETIME(6));</code>。以下为MySQL官方文档中的示例：</p>
<pre><code>mysql&gt; CREATE TABLE fractest( c1 TIME(2), c2 DATETIME(2), c3 TIMESTAMP(2) );
Query OK, 0 rows affected (0.33 sec)

mysql&gt; INSERT INTO fractest VALUES 
     &gt; (&apos;17:51:04.777&apos;, &apos;2014-09-08 17:51:04.777&apos;, &apos;2014-09-08 17:51:04.777&apos;);
Query OK, 1 row affected (0.03 sec)

mysql&gt; SELECT * FROM fractest;
+-------------+------------------------+------------------------+
| c1          | c2                     | c3                     |
+-------------+------------------------+------------------------+
| 17:51:04.78 | 2014-09-08 17:51:04.78 | 2014-09-08 17:51:04.78 |
+-------------+------------------------+------------------------+
1 row in set (0.00 sec)
</code></pre><p>更多信息，参考MySQL官方文档：<a href="http://dev.mysql.com/doc/refman/5.6/en/fractional-seconds.html" target="_blank" rel="external">Fractional Seconds in Time Values</a></p>
<p>至于fractional second为什么直到MySQL 5.6.4才支持以及需要手动指定精确度，个人猜测是多数情况下不需要如此高的精确度，以及高精确度带来的性能问题。</p>
<h3 id="Django中的支持"><a href="#Django中的支持" class="headerlink" title="Django中的支持"></a>Django中的支持</h3><p>似乎到了Django 1.8才对fractional seconds进行支持，创建model时可以使用<code>DATETIME(6)</code>,参见Django 1.8的<a href="https://docs.djangoproject.com/en/dev/releases/1.8/#database-backends" target="_blank" rel="external">release notes</a>和<a href="https://docs.djangoproject.com/en/dev/ref/databases/#mysql-fractional-seconds" target="_blank" rel="external">文档</a>。<br>需要注意的是：</p>
<ol>
<li>使用fractional seconds的最低版本为MySQL 5.6.4和MySQLdb 1.2.5。</li>
<li>Django不会更新已有的数据库，需要执行SQL语句进行修改数据库，或执行Data Migrations操作</li>
<li>对于早期版本，是有hack方案的，参见stackoverflow上的问题<a href="http://stackoverflow.com/questions/17846504/how-to-create-a-django-custom-field-to-store-mysql-datetime6-and-enable-fracti" target="_blank" rel="external">How to create a Django custom Field to store MYSQL DATETIME(6) and enable fractional seconds (milliseconds and or microseconds) in Django/MySQL?</a></li>
</ol>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>显然，在业务需求精确到秒即可满足的情况，为了自动化测试而更改已经部署的MySQL、Django版本及代码是得不偿失的。所以最终较好的解决方案是在自动化测试的代码中把item的生成时间根据生成次序进行二次处理。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://ifchanged.io/2015/Python模拟登录京东/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zeroten">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IFchanged">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/Python模拟登录京东/" itemprop="url">
                  Python模拟登录京东
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-09-13T23:16:01+08:00">
                2015-09-13
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/Python模拟登录京东/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2015/Python模拟登录京东/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="模拟登录的方法"><a href="#模拟登录的方法" class="headerlink" title="模拟登录的方法"></a>模拟登录的方法</h2><p>真实用户在登录网站时，是在登录页面填写自己的账号、密码信息，并点击登录按钮。从实现的角度上讲，实际上是执行了一个Http Post请求，向网站服务器提交数据。模拟登录就是通过程序对这种行为进行模拟，所以一是要准备账号、密码等信息，二是要像用户一样进行post。</p>
<p>但是，通常网站都会限制程序的模拟登录，通常的方法也就是在上面提到的两点上进行检测。一是增加要提交的校验信息，二是检测post的行为。</p>
<p>本文介绍使用Python进行模拟登录京东网，使用PyQuery来捕捉京东增加的校验信息，用requests执行post请求。</p>
<h2 id="数据准备"><a href="#数据准备" class="headerlink" title="数据准备"></a>数据准备</h2><p>首先找到京东的登录页面<a href="https://passport.jd.com/new/login.aspx" target="_blank" rel="external">https://passport.jd.com/new/login.aspx</a> ,随便提交一次，发现post的地址是<a href="https://passport.jd.com/uc/loginService" target="_blank" rel="external">https://passport.jd.com/uc/loginService</a> ，以及post数据为：<br><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">uuid:</span><span class="number">53</span>c85802-XXX-ebdd952dda93</div><div class="line"><span class="symbol">machineNet:</span></div><div class="line"><span class="symbol">machineCpu:</span></div><div class="line"><span class="symbol">machineDisk:</span></div><div class="line"><span class="symbol">SGIARTgLfH:</span>dJGep</div><div class="line"><span class="symbol">loginname:</span>XXXX</div><div class="line"><span class="symbol">nloginpwd:</span>XXX</div><div class="line"><span class="symbol">loginpwd:</span>XXX</div><div class="line"><span class="symbol">chkRememberMe:</span>on</div><div class="line"><span class="symbol">authcode:</span></div></pre></td></tr></table></figure></p>
<p>其中,<code>loginname</code>是用户名，<code>nloginpwd</code>和<code>loginpwd</code>都是密码，<code>uuid</code>、loginname上面的一组数据(本例中为SGIARTgLfH:dJGep)三者都是用于验证登录的随机字符串。<code>authcode</code>为验证码,<code>chkRememberMe</code>为是否自动登录。其他的项留空。</p>
<p>所以，重要的是获取uuid和那组随机数据。这些数据都在登录页面<a href="https://passport.jd.com/new/login.aspx" target="_blank" rel="external">https://passport.jd.com/new/login.aspx</a> 中。检查该页面源码，这些数据都在<form id="formlogin">表格中，使用pyquery进行选择，代码为：<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">uuid = <span class="built_in">d</span>(<span class="string">"#uuid"</span>).attr(<span class="string">"value"</span>)</div><div class="line">left = <span class="built_in">d</span>('#formlogin <span class="keyword">input</span>[<span class="keyword">type</span>=<span class="string">"hidden"</span>]:<span class="keyword">eq</span>(4)').attr(<span class="string">"name"</span>)</div><div class="line">right = <span class="built_in">d</span>('#formlogin <span class="keyword">input</span>[<span class="keyword">type</span>=<span class="string">"hidden"</span>]:<span class="keyword">eq</span>(4)').attr(<span class="string">"value"</span>)</div></pre></td></tr></table></figure></form></p>
<p>另外一个重要数据是验证码，在多次尝试登录或者其他京东不喜欢的情况下，会要求填写验证码。同样使用pyquery查找验证码，代码为：<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attr">auth_img_url</span> = d(<span class="string">'#JD_Verification1'</span>).attr(<span class="string">"src2"</span>)</div></pre></td></tr></table></figure></p>
<p>然后下载验证码，在不是很频繁登录的情况下，手动填写就够了。</p>
<p>需要<strong>注意</strong>的是，京东的网页随时可能修改，post的数据和数据的来源都要根据实际情况确定。</p>
<h2 id="进行登录"><a href="#进行登录" class="headerlink" title="进行登录"></a>进行登录</h2><p>登录操作使用requests，需要注意的是，要使用requests中的Session，首先创建<code>s = requests.Session()</code>，然后使用<code>s.post</code>和<code>s.get</code>进行操作。<code>s.post(login_post_url, data=login_data)</code>即可。返回<code>({&quot;success&quot;:&quot;http://www.jd.com&quot;})</code>表示登录成功，可以使用s会话进行后续操作。</p>
<h2 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h2><p>完整代码如下：</p>
<script src="//gist.github.com/2a1231184de59a725f64.js?file=login_jingdong.py"></script>
<p>或访问gist查看<a href="https://gist.github.com/ladder1984/2a1231184de59a725f64" target="_blank" rel="external">https://gist.github.com/ladder1984/2a1231184de59a725f64</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://ifchanged.io/2015/第2章 词法分析——The Python Language Reference阅读笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zeroten">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IFchanged">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/第2章 词法分析——The Python Language Reference阅读笔记/" itemprop="url">
                  第2章 词法分析——The Python Language Reference阅读笔记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-04-15T23:08:51+08:00">
                2015-04-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程笔记/" itemprop="url" rel="index">
                    <span itemprop="name">编程笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/第2章 词法分析——The Python Language Reference阅读笔记/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2015/第2章 词法分析——The Python Language Reference阅读笔记/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="第二章-词法分析（Lexical-analysis）"><a href="#第二章-词法分析（Lexical-analysis）" class="headerlink" title="第二章 词法分析（Lexical analysis）"></a>第二章 词法分析（Lexical analysis）</h1><p>一个 Python 程序由 <strong>解析器</strong>(parser) 读入, 输入解析器的是由 <strong>词法分析器</strong>(lexical analyzer) 生成的 <strong>语言符号</strong>(token) 流. 本章讨论词法分析器是如何把文件割成若干语言符号的.</p>
<p>Python使用7位ASCII字符作为程序文本（注意：Python3使用Unicode）。</p>
<h2 id="2-1-行结构"><a href="#2-1-行结构" class="headerlink" title="2.1.行结构"></a>2.1.行结构</h2><p>Python程序由逻辑行组成。</p>
<h3 id="2-1-1-逻辑行"><a href="#2-1-1-逻辑行" class="headerlink" title="2.1.1.逻辑行"></a>2.1.1.逻辑行</h3><p>逻辑行的结尾以“换行”（NEWLINE）为标志，语句不能出现在多个逻辑行，除非语法支持（例如符合语句，复合语句在第七章详解）。逻辑行由一个或多个显/隐式连接的物理行。</p>
<p>文档中没有明确给出“NEWLINE”的定义，我的理解是逻辑行形式上等同于组成它的物理行，所以物理行的结束也就是逻辑行的结束。</p>
<h3 id="2-1-2-物理行"><a href="#2-1-2-物理行" class="headerlink" title="2.1.2.物理行"></a>2.1.2.物理行</h3><p>物理行以end-of-line（EOL）结束，这个EOL在每个平台不同。</p>
<blockquote>
<p>以ASCII为基础的或相容的字元集使用分别LF（Line feed，0Ah）或CR（Carriage Return，0Dh）或CR+LF；下面列出各系统换行字元编码的列表</p>
<p>  <strong>LF</strong>：在Unix或Unix相容系统（GNU/Linux，AIX，Xenix，Mac OS X，…）、BeOS、Amiga、RISC OS<br>  <strong>CR+LF</strong>：MS-DOS、微软视窗操作系统（Microsoft Windows）、大部分非Unix的系统<br>  <strong>CR</strong>：Apple II家族，Mac OS至版本9<br>  <a href="http://zh.wikipedia.org/zh-cn/%E6%8F%9B%E8%A1%8C" target="_blank" rel="external">换行 - 维基百科</a></p>
</blockquote>
<p>物理行等同于视觉上看到的行，这个是考验编辑器的事情。</p>
<h3 id="2-1-3-注释"><a href="#2-1-3-注释" class="headerlink" title="2.1.3.注释"></a>2.1.3.注释</h3><p><strong>comment</strong>是以#开头的物理行，会被解释器忽略。文档中并没有提到另一种注释，三个引号(“””)包围的东西，<strong>文档注释（doc string）</strong>。如：</p>
<pre>
def foo():
    """文档注释"""
    return None 
print(foo.__doc__)  
help(foo)
</pre>

<h3 id="2-1-4-编码声明"><a href="#2-1-4-编码声明" class="headerlink" title="2.1.4.编码声明"></a>2.1.4.编码声明</h3><p>声明编码，源文件中第一行或者第二行匹配正则表达式<code>coding[=:]\s*([-\w.]+)</code>的注释，通常写成 # -<em>- coding: utf-8 -</em>- 或者coding=utf8。当然声明的编码Python得认识，通常声明成utf-8就好。</p>
<p><strong>编码设置会用于整个词法分析过程, 包括字符串字面值, 注释和标识符。</strong></p>
<p>另外，Python还能识别UTF-8 byte-order mark (‘\xef\xbb\xbf’)，也就是微软的恶趣味BOM。通常自己编写的文件最好避免出现BOM，读取文本文件时候也要注意BOM。</p>
<h3 id="2-1-5-显式行连接"><a href="#2-1-5-显式行连接" class="headerlink" title="2.1.5.显式行连接"></a>2.1.5.显式行连接</h3><p>行连接是为了把多个物理行连接成一个逻辑行，显式即是通过反斜杠（\,backslashe）。要注意的反斜杠后面不能有注释。</p>
<h3 id="2-1-6-隐式行连接"><a href="#2-1-6-隐式行连接" class="headerlink" title="2.1.6.隐式行连接"></a>2.1.6.隐式行连接</h3><p>圆括号()、方括号[]、花括号{}中多个物理行的内容不需要显式连接，并且可以添加注释。例如：</p>
<pre>
month_names = ['Januari', 'Februari', 'Maart',  # These are the
   'April',   'Mei',  'Juni',   # Dutch names
   'Juli','Augustus', 'September',  # for the months
   'Oktober', 'November', 'December']   # of the year
</pre>

<h3 id="2-1-7-空行"><a href="#2-1-7-空行" class="headerlink" title="2.1.7.空行"></a>2.1.7.空行</h3><p>简单来说，空的行在解析时会被忽略。所谓空行就是只有空格、制表符、进纸符和注释的逻辑行。在交互时，空行根据具体实现而定。</p>
<h3 id="2-1-8-缩进"><a href="#2-1-8-缩进" class="headerlink" title="2.1.8.缩进"></a>2.1.8.缩进</h3><p>缩进用来区分语句是Python最明显的特色，缩进可以使用制表符（tab）或者空格，在解析时候tab会被先转换成空格，推荐使用四个空格的方式。</p>
<p>另外，用<strong>分号(;)</strong>将多个语句写在同一行上，语句之间用分号隔开，而这些语句也不能在这行开始一个新的代码块。例如：<code>a=1;a=2</code>。不过，不推荐这样做，也基本没见过这样写的Python代码。</p>
<p>Python用栈来控制缩进，详情看官方文档：<a href="https://docs.python.org/2/reference/lexical_analysis.html#indentation" title="Indentation" target="_blank" rel="external">Indentation</a></p>
<h3 id="2-1-9-语言符号间的空白符"><a href="#2-1-9-语言符号间的空白符" class="headerlink" title="2.1.9.语言符号间的空白符"></a>2.1.9.语言符号间的空白符</h3><p>除了在行首、字符串中这样的特殊位置，空白符的作用就是把标记分号，如把变量<strong>ab</strong>分隔成<strong>a b</strong>两个变量。</p>
<h2 id="2-2-其他记号"><a href="#2-2-其他记号" class="headerlink" title="2.2.其他记号"></a>2.2.其他记号</h2><p>除了换行（NEWLINE）、缩进（INDENT）、DEDENT（啥？），语言记号包括：标识符、关键字、字面值、运算符 和 分隔符。空白符不是。</p>
<h2 id="2-3-标识符和关键字"><a href="#2-3-标识符和关键字" class="headerlink" title="2.3.标识符和关键字"></a>2.3.标识符和关键字</h2><p>标识符（Identifier）也叫做名字，就是平时所说的变量名一类，词法定义如下：</p>
<blockquote>
<p>identifier ::=  (letter|”<em>“) (letter | digit | “</em>“)*<br>  letter     ::=  lowercase | uppercase<br>  lowercase  ::=  “a”…”z”<br>  uppercase  ::=  “A”…”Z”<br>  digit      ::=  “0”…”9”</p>
</blockquote>
<p>标识符不限长度，大小写敏感，Python的标识符要求和其他语言基本一样。<br>另外，标识符命名推荐使用”_”分隔，而不是大小写的驼峰法，具体推荐命名法见PEP8。</p>
<h3 id="2-3-1-关键字"><a href="#2-3-1-关键字" class="headerlink" title="2.3.1.关键字"></a>2.3.1.关键字</h3><p>Python 2的关键字就这么多：</p>
<blockquote>
<p>and       del       from      not       while<br>  as        elif      global    or        with<br>  assert    else      if        pass      yield<br>  break     except    import    print<br>  class     exec      in        raise<br>  continue  finally   is        return<br>  def       for       lambda    try</p>
</blockquote>
<p>顺带附上Python 3.4的关键字：</p>
<blockquote>
<p>False      class      finally    is         return<br>  None       continue   for        lambda     try<br>  True       def        from       nonlocal   while<br>  and        del        global     not        with<br>  as         elif       if         or         yield<br>  assert     else       import     pass<br>  break      except     in         raise</p>
</blockquote>
<h3 id="2-3-2-保留的标识符类型"><a href="#2-3-2-保留的标识符类型" class="headerlink" title="2.3.2.保留的标识符类型"></a>2.3.2.保留的标识符类型</h3><p><code>_*</code>：不会在from module import &#42;时被导入<br><code>__*__</code>:系统保留的名字，所以自己写的时候就不用这种名字格式<br><code>__*</code>:类的私有名</p>
<h2 id="2-4-字面值"><a href="#2-4-字面值" class="headerlink" title="2.4.字面值"></a>2.4.字面值</h2><p>字面值是某些内置类型的常量值的表示法</p>
<h3 id="2-4-1-字符串字面值"><a href="#2-4-1-字符串字面值" class="headerlink" title="2.4.1.字符串字面值"></a>2.4.1.字符串字面值</h3><p>词法定义,见<a href="https://docs.python.org/2/reference/lexical_analysis.html#string-literals" target="_blank" rel="external">String literals</a>：</p>
<pre>
stringliteral   ::=  [stringprefix](shortstring | longstring)
stringprefix    ::=  "r" | "u" | "ur" | "R" | "U" | "UR" | "Ur" | "uR"
                     | "b" | "B" | "br" | "Br" | "bR" | "BR"
shortstring     ::=  "'" shortstringitem* "'" | '"' shortstringitem* '"'
longstring      ::=  "'''" longstringitem* "'''"
                     | '"""' longstringitem* '"""'
shortstringitem ::=  shortstringchar | escapeseq
longstringitem  ::=  longstringchar | escapeseq
shortstringchar ::=  <any source="" character="" except="" "\"="" or="" newline="" the="" quote="">
longstringchar  ::=  <any source="" character="" except="" "\"="">
escapeseq       ::=  "\" <any ascii="" character="">
</any></any></any></pre>

<p>前缀：<br>r:表示原始字符串（raw strings），即不对字符串里的\进行特殊处理<br>u：表示Unicode字符串<br>b：b在Python 中没用，它是用于告诉2to3的自动转换程序，这个字符串转换成3后应该是个字节字面值。</p>
<h3 id="2-4-2-字符串字面值的连接"><a href="#2-4-2-字符串字面值的连接" class="headerlink" title="2.4.2.字符串字面值的连接"></a>2.4.2.字符串字面值的连接</h3><p>简单来说，写在一起的字符串会自动连接到一起，如”hello” ‘world’会自动连接成”helloworld”</p>
<p>注意这个功能是在语法层次上定义的, 但却是在编译时实现的。 在运行时连接字符串表达式必须使用” +” 运算符。在字面值连接时, 不同的引用字符可以混用, 甚至原始串与三重引用串也可以混合使用.</p>
<h3 id="2-4-4数值型字面值"><a href="#2-4-4数值型字面值" class="headerlink" title="2.4.4数值型字面值"></a>2.4.4数值型字面值</h3><p>Python 2有四种字面值：普通整数（plain integers）、长整数（long integers）、浮点数（floating point numbers）、虚数（imaginary numbers）（Python 3中只有三种，只有整数）。复数用实数+虚数的形式表示。</p>
<p>词法定义：</p>
<pre>
longinteger    ::=  integer ("l" | "L")
integer        ::=  decimalinteger | octinteger | hexinteger | bininteger
decimalinteger ::=  nonzerodigit digit* | "0"
octinteger     ::=  "0" ("o" | "O") octdigit+ | "0" octdigit+
hexinteger     ::=  "0" ("x" | "X") hexdigit+
bininteger     ::=  "0" ("b" | "B") bindigit+
nonzerodigit   ::=  "1"..."9"
octdigit       ::=  "0"..."7"
bindigit       ::=  "0" | "1"
hexdigit       ::=  digit | "a"..."f" | "A"..."F"
</pre>

<p>要注意的是L要大写，来和数字1区分。Python 3对整数的统一更有好些，在Python 2中，数值溢出时候会自动转换成带L后缀的长整数。长整数的取值范围没有限制，由可用内存而定。</p>
<p>参考阅读：<a href="https://docs.python.org/2/library/sys.html#sys.maxint" target="_blank" rel="external">sys.maxint</a></p>
<h3 id="2-4-5-浮点型字面值"><a href="#2-4-5-浮点型字面值" class="headerlink" title="2.4.5.浮点型字面值"></a>2.4.5.浮点型字面值</h3><p>词法定义：</p>
<pre>
floatnumber   ::=  pointfloat | exponentfloat
pointfloat    ::=  [intpart] fraction | intpart "."
exponentfloat ::=  (intpart | pointfloat) exponent
intpart       ::=  digit+
fraction      ::=  "." digit+
exponent      ::=  ("e" | "E") ["+" | "-"] digit+
</pre>

<p>浮点数的取值范围依赖于实现。注意整数部分和指数部分都看作是十进制的. 例如, 077e010 是合法的, 它等价于 77e10,下面这些奇奇怪怪的形式也是可以的:<br>3.14    10.    .001    1e100    3.14e-10    0e0</p>
<p>浮点型的取值范围和机器有关，可以使用sys.float_info查看相关信息，会得到这样的结果：</p>
<blockquote>
<p>sys.float_info(max=1.7976931348623157e+308, max_exp=1024, max_10_exp=308, min=2.2250738585072014e-308, min_exp=-1021, min_10_exp=-307, dig=15, mant_dig=53, epsilon=2.220446049250313e-16, radix=2, rounds=1)</p>
</blockquote>
<p>参考阅读：<a href="https://docs.python.org/2/library/sys.html#sys.float_info" target="_blank" rel="external">sys.float_info</a></p>
<h3 id="2-4-6-虚数字面值"><a href="#2-4-6-虚数字面值" class="headerlink" title="2.4.6.虚数字面值"></a>2.4.6.虚数字面值</h3><p>词法定义：<br>imagnumber ::=  (floatnumber | intpart) (“j” | “J”)</p>
<p>虚数是实部为零的复数. 复数由一对有着相同取值范围的浮点数表示. 为了创建一个非零实部的复数, 可以对它增加一个浮点数, 例如, (3+4j). 下面是一些例子:<br>3.14j   10.j    10j     .001j   1e100j  3.14e-10j</p>
<h2 id="2-5-运算符"><a href="#2-5-运算符" class="headerlink" title="2.5.运算符"></a>2.5.运算符</h2><p>运算符包括：</p>
<pre>
+       -       *       **      /       //      %
<<      >     &       |       ^       ~
<             <=>=      ==      !=      <>
</=></pre>

<p>其中!=和&lt;&gt;是一个意思，不建议使用后者，并且它在Python 3中已经取消。</p>
<h2 id="2-6-分隔符"><a href="#2-6-分隔符" class="headerlink" title="2.6.分隔符"></a>2.6.分隔符</h2><p>分隔符包括：</p>
<pre>
(       )       [       ]       {       }
,       :       .       ;       @       =
+=      -=      *=      /=      //=     %=
&=      |=      ^=      >>=     <<= **="</pre"></=></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://ifchanged.io/2015/第1章 简介——The Python Language Reference阅读笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zeroten">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IFchanged">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/第1章 简介——The Python Language Reference阅读笔记/" itemprop="url">
                  第1章 简介——The Python Language Reference阅读笔记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-04-14T23:10:25+08:00">
                2015-04-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程笔记/" itemprop="url" rel="index">
                    <span itemprop="name">编程笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2015/第1章 简介——The Python Language Reference阅读笔记/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2015/第1章 简介——The Python Language Reference阅读笔记/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="关于阅读笔记"><a href="#关于阅读笔记" class="headerlink" title="关于阅读笔记"></a>关于阅读笔记</h1><p>《The Python 2 Language Reference阅读笔记》系列文章是我阅读Python 2的The Python Language Reference所记的笔记，不是翻译，也不会全部罗列Reference所讲的全部内容，而是记一些笔记和心得。</p>
<p>在笔记中有我对文档的一些理解，以及相关内容的资料，文档原文在<a href="https://docs.python.org/2/reference/index.html" target="_blank" rel="external">The Python Language Reference</a>，另有一份中文翻译<a href="http://python.usyiyi.cn/python_278/reference/index.html" target="_blank" rel="external">Python 语言参考</a>，没有完整阅读过翻译，翻译质量未知。</p>
<hr>
<h1 id="第一章-简介"><a href="#第一章-简介" class="headerlink" title="第一章 简介"></a>第一章 简介</h1><h2 id="1-1-可选实现"><a href="#1-1-可选实现" class="headerlink" title="1.1.可选实现"></a>1.1.可选实现</h2><p>常见的Python实现有CPython、Jython、Python for .NET、IronPython、Pypy。</p>
<p>Cpython是最流行的的实现，C编写，也是官方的实现。Jython是Java的实现。Python for .NET和IronPython都是.Net相关的实现。PyPy是用Python本身实现的Python，值得关注。</p>
<h2 id="1-2-记号法"><a href="#1-2-记号法" class="headerlink" title="1.2.记号法"></a>1.2.记号法</h2><p>Reference的词法和语法分析描述方法由巴克斯范式（BNF）修改而来，比较简单。</p>
<blockquote>
<p>name      ::=  lc_letter (lc<em>letter | “</em>“)*<br>  lc_letter ::=  “a”…”z”</p>
</blockquote>
<p>第一行是说name是一个lc_letter，后面跟着一个零个或多个lc_letter和下划线组成的序列。接着，一个lc_letter是’a’到’z’之间任意一个单个字符。（这个规则事实上就是该文档中词法和语法规则中的名称的定义方式。）</p>
<p>每条规则以一个名字（这条规则定义的名字）和::=开始。竖线(|)用于分隔可选的项；它是该语法符号中绑定性最弱的操作符。星号(&#42;)表示前面项目的零个或多个重复；类似地, 加号(+)表示一个或多个重复, 而方括号([ ])表示里面的内容出现零次或一次（换句话说, 方括号中的内容是可选的）。*和+操作符的绑定性最强；圆括号用于分组。字符串字面值由引号引起来。空格只对分隔标识符有意义。规则通常包含在单独的一行中；具有许多可选项的规则可能会在第一行之后，每一行以一个竖线开始。</p>
<p>在词法定义中（如上面的例子），还使用了两个额外的约定：三个点号分隔的两个字符表示给出的范围内（包括这两个字符）的任何一个单个ASCII字符。尖括号(&lt;…&gt;)中的内容表示不是定义的符号的正式描述；例如，如果需要这可以用来描述‘控制字符’的概念。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://ifchanged.io/2014/把wordpress迁移到子目录/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zeroten">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IFchanged">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/把wordpress迁移到子目录/" itemprop="url">
                  把wordpress迁移到子目录
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-12-12T23:56:13+08:00">
                2014-12-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/网站建设/" itemprop="url" rel="index">
                    <span itemprop="name">网站建设</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/把wordpress迁移到子目录/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2014/把wordpress迁移到子目录/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>之前把wordpress安装在根目录，虽然这样建立wordpress很方便，但也会把根目录弄得很混乱，尤其是建立其他站点时很不方便，好在把wordpress迁移到子目录，并且<strong>不改变站点地址</strong>并不麻烦。</p>
<p>方法可以参考官方文档<a href="http://codex.wordpress.org/zh-cn:%E5%B0%86_WordPress_%E6%96%87%E4%BB%B6%E7%BD%AE%E4%BA%8E%E7%8B%AC%E7%AB%8B%E5%AD%90%E7%9B%AE%E5%BD%95" target="_blank" rel="external">将 WordPress 文件置于独立子目录</a>。</p>
<h2 id="迁移方法"><a href="#迁移方法" class="headerlink" title="迁移方法"></a>迁移方法</h2><ol>
<li>建立子目录，如wordpress</li>
<li>进入wordpress后台的<strong>设置</strong> - <strong>常规</strong>，设置index.php 和 .htaccess为新的地址，比如<a href="http://www.itoldme.net/wordpress，站点地址（URL）无需修改。" target="_blank" rel="external">http://www.itoldme.net/wordpress，站点地址（URL）无需修改。</a></li>
<li>把wordpress所有文件<strong>剪切</strong>到wordpress目录下</li>
<li>把index.php 和 .htaccess<strong>复制</strong>到根目录</li>
<li>编辑index.php，require(‘./wp-blog-header.php’); 修改为 require(‘./wordpress/wp-blog-header.php’); 其中的wordpress是你的子目录</li>
<li>此刻站点迁移完成，新的后台地址将会添加子目录，比如成为<a href="http://example.com/wordpress/wp-admin/" target="_blank" rel="external">http://example.com/wordpress/wp-admin/</a></li>
</ol>
<h2 id="注意事项："><a href="#注意事项：" class="headerlink" title="注意事项："></a>注意事项：</h2><ol>
<li><p>如果图片放置在wordpress中，由于wordpress采用绝对路径，所以新的图片路径也变了，会在wp-content前添加子目录名称，如www.itoldme.net/wordpress/wp-content/uploads/。则文章中引用的图片路径需要修改，方法是修改数据库。如果不会sql语句的话，可以使用插件<strong>Search &amp; Replace</strong>，把www.itoldme.net/wp-content/uploads/全部替换成www.itoldme.net/wordpress/wp-content/uploads/，如图<img src="http://www.itoldme.net/wordpress/wp-content/uploads/2014/12/20141212235031.png" alt="Search &amp; Replace示意图"></p>
</li>
<li><p>如果启用了WP Super Cache的CDN功能，需要在站点地址Off-site URL中添加子目录，如图<img src="http://www.itoldme.net/wordpress/wp-content/uploads/2014/12/20141213000651.png" alt="cdn设置示意图"></p>
</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://ifchanged.io/2014/你好，Linode/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zeroten">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IFchanged">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/你好，Linode/" itemprop="url">
                  你好，Linode
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-12-01T22:39:46+08:00">
                2014-12-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/About互联网/" itemprop="url" rel="index">
                    <span itemprop="name">About互联网</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/你好，Linode/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2014/你好，Linode/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>一直对Linode很向往，恰巧Linode黑色星期五优惠，新用户赠送25美元，就入手了，可惜忘了使用lindoe10的优惠码，10美元就擦肩而过了。本来打算和同学合租个VPS玩玩的，不过恰巧有此优惠就入手了，毕竟Linode价格不便宜。</p>
<h2 id="支付方式"><a href="#支付方式" class="headerlink" title="支付方式"></a>支付方式</h2><p>Linode不支持支付宝，不过要感谢腾讯财付通的虚拟运通卡，可以轻轻松松支付美元。进入财付通，点击“境外支付”就能找到相关功能。</p>
<h2 id="初体验"><a href="#初体验" class="headerlink" title="初体验"></a>初体验</h2><p>由于现在没有时间，所以暂未开通VPS，具体的使用体验要等到一个月后了。不过，也感受到了VPS优质的服务。</p>
<p>因为初次使用，所以误开通了一个最贵的VPS，本以为我的账户余额没这么多不会开通，结果原来Linode按照时间计算，所以立刻扣除了一小时的费用1.44美元。还好我立刻删除了这个VPS，不过也知道不要随便点，Linode提交订单前没有“确定”。然后立刻发了个ticket给客服，看样子我的英语还勉强可以，客服理解了我的意思，并很快退还了费用。</p>
<p>&nbsp;</p>
<h2 id="未来。。。"><a href="#未来。。。" class="headerlink" title="未来。。。"></a>未来。。。</h2><p>等考完就可以尽情折腾了，把之前写的网站都可以放在上面，然后折腾折腾linux，各种折腾折腾。一个月时间也很快，祝我好运~</p>
<p>等一个月后，再来续写这篇文章。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://ifchanged.io/2014/自动更新host的软件updateHosts/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zeroten">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IFchanged">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/自动更新host的软件updateHosts/" itemprop="url">
                  自动更新host的软件updateHosts
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-10-26T22:27:02+08:00">
                2014-10-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程笔记/" itemprop="url" rel="index">
                    <span itemprop="name">编程笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/自动更新host的软件updateHosts/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2014/自动更新host的软件updateHosts/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="updateHosts"><a href="#updateHosts" class="headerlink" title="updateHosts"></a>updateHosts</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>自动从网络下载hosts文件，hosts源由用户设置。</p>
<h3 id="hosts是什么？"><a href="#hosts是什么？" class="headerlink" title="hosts是什么？"></a>hosts是什么？</h3><blockquote>
<p>hosts文件是一个用于储存计算机网络中各节点信息的计算机文件。这个文件负责将主机名映射到相应的IP地址。hosts文件通常用于补充或取代网络中DNS的功能。和DNS不同的是，计算机的用户可以直接对hosts文件进行控制。 ——<a href="http://zh.wikipedia.org/zh-cn/Hosts%E6%96%87%E4%BB%B6" title="hosts文件 - 维基百科，自由的百科全书" target="_blank" rel="external">hosts文件 - 维基百科，自由的百科全书</a></p>
</blockquote>
<h3 id="hosts的功能"><a href="#hosts的功能" class="headerlink" title="hosts的功能"></a>hosts的功能</h3><blockquote>
<p>hosts文件也可以用于其它情况，例如可以将已知的广告服务器重定向到无广告的机器（通常是本地的IP地址：127.0.0.1）上来过滤广告。同时也可以通过不下载网络广告，从而减少带宽。使用hosts文件还可以减少对DNS服务器的访问来加快访问速度并减少带宽消耗。</p>
<p>  hosts文件的另一个重要用途就是用于拦截一些恶意网站的请求，从而防止访问欺诈网站或感染一些病毒或恶意软件。但同时，这个文件也可能被病毒或恶意软件所利用来阻止用户更新杀毒软件或访问特定网站。</p>
<p>  在中国大陆，由于防火长城的DNS劫持，有一些网民也借使用hosts文件来强制将特定网站指定到未封锁的IP上。例如网络上有很多教授修改hosts文件来访问Google搜索的教程。比如就有维基媒体基金会的图片服务器IP地址被ISP封锁，通过修改hosts文件以正常显示图片的方法流传。  ——<a href="http://zh.wikipedia.org/zh-cn/Hosts%E6%96%87%E4%BB%B6" title="hosts文件 - 维基百科，自由的百科全书" target="_blank" rel="external">hosts文件 - 维基百科，自由的百科全书</a></p>
</blockquote>
<h3 id="updateHosts的功能"><a href="#updateHosts的功能" class="headerlink" title="updateHosts的功能"></a>updateHosts的功能</h3><p>updateHosts可以自动从网络下载最新的hosts文件，并自动替换系统的hosts文件。更多更能请见下文描述。</p>
<h2 id="使用说明"><a href="#使用说明" class="headerlink" title="使用说明"></a>使用说明</h2><p>下载地址：<a href="https://github.com/ladder1984/updateHosts/archive/master.zip" target="_blank" rel="external">https://github.com/ladder1984/updateHosts/archive/master.zip</a> 解压即可使用。</p>
<h3 id="运行方法"><a href="#运行方法" class="headerlink" title="运行方法"></a>运行方法</h3><ul>
<li><strong>Windows用户</strong>：点击<strong>start.vbs</strong>运行，点击<strong>addToStartup.js</strong>加入启动项。无须安装Python。</li>
<li><strong>Linux/Mac OS用户</strong>：如未安装Python，请自行安装Python 2.x。点击<strong>updateHosts.py</strong>执行程序。</li>
</ul>
<h3 id="文件说明"><a href="#文件说明" class="headerlink" title="文件说明"></a>文件说明</h3><ul>
<li><strong>config.ini：</strong> 设置参数，包括选择更新源、开启关闭功能。详见config.ini中的注释<em>   <em>*hosts_user_defined.txt：</em></em> 可填入自定义hosts内容</li>
</ul>
<h3 id="设置说明"><a href="#设置说明" class="headerlink" title="设置说明"></a>设置说明</h3><p>目前可以在config.ini文件中方设置功能。0为不开启，1为开启此功能。目前可设置的功能有：</p>
<ul>
<li>not_block_sites 开启后，将注释掉通过127.0.0.1屏蔽的网址</li>
<li>always_on 开启后，将常驻内存，每小时执行一次更新</li>
</ul>
<p><strong>注意：</strong></p>
<ul>
<li>本软件不提供hosts文件，而是从从用户定义的地址下载hosts，默认提供几个流行的hosts，参见config.ini</li>
<li>建议使用前手动备份hosts文件</li>
<li>Windows用户可能需要授予程序管理员权限：右击python27.exe，选中“属性”，在“兼容性”里勾选“以管理员身份运行此程序”。</li>
<li>建议使用Notepad++、Sublime Text编辑文件</li>
<li>删除启动项（Windows用户）：删除“启动”文件夹内的快捷方式，“启动”文件夹在开始菜单内</li>
</ul>
<h2 id="运行环境"><a href="#运行环境" class="headerlink" title="运行环境"></a>运行环境</h2><ul>
<li>操作系统：Windows、Linux、Mac OS</li>
</ul>
<h2 id="功能描述"><a href="#功能描述" class="headerlink" title="功能描述"></a>功能描述</h2><ul>
<li>下载hosts文件并更新本地hosts</li>
<li>用户可自定义hosts内容</li>
<li>可选的hosts更新源</li>
<li>可以选择下载多个hosts文件并合并</li>
<li>备份hosts文件</li>
<li>可去除屏蔽广告部分</li>
<li>可常驻后台，可每小时执行一次</li>
<li>分离出单独的配置文件</li>
<li>运行时不显示窗口</li>
<li>打包成exe文件，无需安装python即可使用</li>
<li>可单文件执行updateHosts</li>
<li>可添加启动项</li>
<li>生成错误日志errorLog.txt</li>
<li>待添加</li>
</ul>
<h2 id="hosts源"><a href="#hosts源" class="headerlink" title="hosts源"></a>hosts源</h2><p>hosts源来源于网络，收录入<a href="https://github.com/ladder1984/someHosts" target="_blank" rel="external">someHosts</a>项目，并选取如下hosts：</p>
<ul>
<li>simpleu-hosts <a href="https://github.com/vokins/simpleu" target="_blank" rel="external">https://github.com/vokins/simpleu</a></li>
<li>google-hosts <a href="https://github.com/txthinking/google-hosts" target="_blank" rel="external">https://github.com/txthinking/google-hosts</a></li>
<li>GavinHosts <a href="http://blog.crpuer.com/GavinHosts.txt" target="_blank" rel="external">http://blog.crpuer.com/GavinHosts.txt</a></li>
<li>General Hosts (ghosts) <a href="http://h.heartnn.eu.org/hosts" target="_blank" rel="external">http://h.heartnn.eu.org/hosts</a></li>
<li>imouto.host <a href="https://github.com/zxdrive/imouto.host" target="_blank" rel="external">https://github.com/zxdrive/imouto.host</a></li>
</ul>
<p>用户可在config.ini中选择，或者自定义hosts源。</p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ul>
<li>updateHosts项目地址：<a href="https://github.com/ladder1984/updateHosts" target="_blank" rel="external">https://github.com/ladder1984/updateHosts</a></li>
<li>ChangeLog：<a href="https://github.com/ladder1984/updateHosts/blob/master/ChangeLog.txt" target="_blank" rel="external">https://github.com/ladder1984/updateHosts/blob/master/ChangeLog.txt</a></li>
<li>作者：<a href="https://github.com/ladder1984" target="_blank" rel="external">https://github.com/ladder1984</a> 博客：<a href="http://www.itoldme.net" target="_blank" rel="external">http://www.itoldme.net</a></li>
<li>欢迎反馈问题和建议，地址：<a href="https://github.com/ladder1984/updateHosts/issues" target="_blank" rel="external">https://github.com/ladder1984/updateHosts/issues</a></li>
</ul>
<h2 id="版权声明"><a href="#版权声明" class="headerlink" title="版权声明"></a>版权声明</h2><ul>
<li>本软件使用MIT协议</li>
</ul>
<hr>
<p>本文不再更新，updateHosts目前情况，请访问项目主页：<a href="https://github.com/ladder1984/updateHosts" target="_blank" rel="external">https://github.com/ladder1984/updateHosts</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://ifchanged.io/2014/Python用PyInstaller打包笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zeroten">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="IFchanged">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2014/Python用PyInstaller打包笔记/" itemprop="url">
                  Python用PyInstaller打包笔记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-10-22T21:37:11+08:00">
                2014-10-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/编程笔记/" itemprop="url" rel="index">
                    <span itemprop="name">编程笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/Python用PyInstaller打包笔记/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2014/Python用PyInstaller打包笔记/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>为了把python发行到没有安装python的Windows环境使用，需要打包成exe可执行文件。现在常见的python打包工具有cx_Freeze、PyInstaller和py2exe，想想我当初接触python的时候，似乎只有py2exe，而且有不少问题时光荏苒，一切过的真快。本文介绍PyInstaller打包的使用。</p>
<h2 id="一-准备工作"><a href="#一-准备工作" class="headerlink" title="一.准备工作"></a>一.准备工作</h2><h3 id="安装PyWin32"><a href="#安装PyWin32" class="headerlink" title="安装PyWin32"></a>安装PyWin32</h3><p>到<a href="http://sourceforge.net/projects/pywin32/" target="_blank" rel="external">http://sourceforge.net/projects/pywin32/</a>下载 PyWin32，本文使用的是 pywin32-219.win-amd64-py2.7，地址：<a href="http://sourceforge.net/projects/pywin32/files/pywin32/Build%20219/pywin32-219.win-amd64-py2.7.exe/download" target="_blank" rel="external">http://sourceforge.net/projects/pywin32/files/pywin32/Build%20219/pywin32-219.win-amd64-py2.7.exe/download</a></p>
<h3 id="下载PyInstaller"><a href="#下载PyInstaller" class="headerlink" title="下载PyInstaller"></a>下载PyInstaller</h3><p>到<a href="http://www.pyinstaller.org/" target="_blank" rel="external">http://www.pyinstaller.org/</a>下载PyInstaller并解压缩。本文使用PyInstaller 2.1。</p>
<p><strong>或者</strong>使用pip安装，执行<strong>pip install pyinstaller</strong></p>
<h3 id="下载upx（可选）"><a href="#下载upx（可选）" class="headerlink" title="下载upx（可选）"></a>下载upx（可选）</h3><p>到<a href="http://upx.sourceforge.net/" target="_blank" rel="external">http://upx.sourceforge.net/</a>下载upx，解压后把upx放在PyInstaller目录下，upx的作用是给生成的exe加壳，减小体积。</p>
<h2 id="二-使用方法"><a href="#二-使用方法" class="headerlink" title="二.使用方法"></a>二.使用方法</h2><p>cmd切换到PyInstaller文件夹，执行命令，如：</p>
<blockquote>
<p>pyinstaller myscript.py</p>
</blockquote>
<p>当然也可以添加输出选项，获得更好的exe可执行文件，如：</p>
<blockquote>
<p>python pyinstaller.py –upx-dir -F xxx.py</p>
</blockquote>
<p>-F用于制作独立的可执行程序，–upx-dir用于压缩文件。</p>
<p><strong>注意：</strong></p>
<ul>
<li>网上教程常见的-X选项启用upx已经失效</li>
<li>如果upx.exe已经复制到PyInstaller文件夹下，会默认使用upx，如果不在文件夹下，可以使用–upx-dir选项，如–upx-dir=upx_dir，如–upx-dir=/usr/local/share/</li>
<li>如果upx.exe复制到了PyInstaller文件夹下，如果不想使用upx，需要添加参数 –noupx</li>
</ul>
<h2 id="三-常用参数介绍"><a href="#三-常用参数介绍" class="headerlink" title="三.常用参数介绍"></a>三.常用参数介绍</h2><p>-F 用于制作独立的可执行程序</p>
<p>–upx-dir 使用upx加壳从而压缩exe文件</p>
<p>–noconsole适用于Windows和Mac OS X，用于创建不显示控制台窗口的程序</p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>PyInstaller可以用于多个平台的打包，包括 Windows (32-bit and 64-bit),Linux (32-bit and 64-bit),Mac OS X (32-bit and 64-bit),experimentally Solaris and AIX。</p>
<p>PyInstaller也可以自定义ico文件等，完整使用手册参见<a href="http://pythonhosted.org/PyInstaller/" title="官方文档" target="_blank" rel="external">http://pythonhosted.org/PyInstaller/</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="zeroten" />
          <p class="site-author-name" itemprop="name">zeroten</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">86</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">10</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">42</span>
                <span class="site-state-item-name">标签</span>
              
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/ladder1984" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zeroten</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  

    
      <script id="dsq-count-scr" src="https://ifchanged.disqus.com/count.js" async></script>
    

    

  













  





  

  

  

  

</body>
</html>
